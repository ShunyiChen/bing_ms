import{_ as ce,r as b,I as pe,Z as Pe,M as fe,w as De,h as g,N as ne,R as Be,o as V,j as S,e as a,k as _,d as e,f as l,i as B,D as Ve,n as q,c as I,F as ee,C as le,t as ve,O as ge,x as P,$ as qe,b as Me,m as me,a0 as Fe,z as Ee,l as Re,G as ol,v as G,a1 as nl,H as rl}from"./index-CAgRbO-3.js";import{l as Te,f as sl,a as ul,g as dl,E as il,b as ml}from"./index-5htLQHb7.js";const cl={class:"form-row"},pl={class:"form-row"},fl={class:"form-row"},vl={class:"form-row"},gl={class:"form-row"},bl={class:"form-row"},yl={class:"form-row"},_l={class:"form-row"},Vl={class:"form-row"},wl={__name:"index",props:{showSearch:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},getDicts:{type:Function,required:!0}},emits:["update:loading","getSearchResult","getCount"],setup(ae,{expose:A,emit:Z}){const Q=ae,{proxy:K}=ve(),{legaldb_device_type:H,legaldb_remark:j,legaldb_office:U}=Q.getDicts(),F=b(!1),Y=b(!1),M=b([]),k=pe({queryParams:{staffNo:null,lpn:null,staffName:null,email:null,offices:null,serviceLine:null,rankName:null,createdBy:null,created:null,status:null,rejectReason:null,deviceType:null,eyAssetNo:null,serialNo:null,receivedBy:null,engagementCode:null,engagementName:null,cancelReason:null,fidsReceivedBy:null,fidsReceivedDate:null,deviceLocation:null,approved:null,rejected:null,approver:null,rejecter:null,createdDateRange:null,returnedDateRange:null,fidsReceivedDateRange:null,approvedDateRange:null,rejectedDateRange:null,pageNum:1,pageSize:Number(Pe.local.get("displayPageRows"))||10,findWhat:null,scope:[]},rules:{staffNo:[{required:!0,message:"gpn员工编号不能为空",trigger:"blur"}],lpn:[{required:!0,message:"$comment不能为空",trigger:"blur"}],createdBy:[{required:!0,message:"创建人不能为空",trigger:"blur"}],created:[{required:!0,message:"创建时间不能为空",trigger:"blur"}],status:[{required:!0,message:"审核状态不能为空",trigger:"change"}]}}),{queryParams:n}=fe(k),L=Z;function h(){z()}function x($){n.value.status=$,z()}function z(){L("update:loading",!0),Te(n.value).then($=>{L("getSearchResult",$.table,n.value),L("getCount",$.count),L("update:loading",!1)}).catch($=>{L("update:loading",!1)})}function m(){n.value.findWhat=null,n.value.scope=[],K.resetForm("queryRef"),h()}const W=$=>{Y.value=!1,$?n.value.offices=U.value.map(s=>s.value):n.value.offices=[]};return De(M,$=>{$.length===0?(F.value=!1,Y.value=!1):$.length===U.value.length?(F.value=!0,Y.value=!1):Y.value=!0}),A({initGetList:x,resetQuery:m}),($,s)=>{const f=g("el-input"),c=g("el-form-item"),C=g("el-checkbox"),u=g("el-option"),o=g("el-select"),p=g("el-date-picker"),T=g("el-button"),E=g("el-form");return ne((V(),S(E,{model:l(n),ref:"queryRef",inline:!0,"label-width":"155","label-suffix":":",class:"custom-form"},{default:a(()=>[_("div",cl,[e(c,{label:"GPN",prop:"staffNo",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).staffNo,"onUpdate:modelValue":s[0]||(s[0]=r=>l(n).staffNo=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"LPN",prop:"lpn",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).lpn,"onUpdate:modelValue":s[1]||(s[1]=r=>l(n).lpn=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"Staff Name",prop:"staffName",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).staffName,"onUpdate:modelValue":s[2]||(s[2]=r=>l(n).staffName=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1})]),_("div",pl,[e(c,{label:"Email",prop:"email",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).email,"onUpdate:modelValue":s[3]||(s[3]=r=>l(n).email=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"Office",prop:"offices",class:"custom-form-item"},{default:a(()=>[e(o,{modelValue:l(n).offices,"onUpdate:modelValue":s[5]||(s[5]=r=>l(n).offices=r),multiple:"",clearable:"","collapse-tags":"",placeholder:"Select","popper-class":"custom-header","max-collapse-tags":1,style:{width:"100%"}},{header:a(()=>[e(C,{modelValue:l(F),"onUpdate:modelValue":s[4]||(s[4]=r=>Ve(F)?F.value=r:null),indeterminate:l(Y),onChange:W},{default:a(()=>[q(" All ")]),_:1},8,["modelValue","indeterminate"])]),default:a(()=>[(V(!0),I(ee,null,le(l(U),r=>(V(),S(u,{key:r.value,label:r.label,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"Dept/Service Line",prop:"serviceLine",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).serviceLine,"onUpdate:modelValue":s[6]||(s[6]=r=>l(n).serviceLine=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1})]),_("div",fl,[e(c,{label:"EY Rank",prop:"rankName",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).rankName,"onUpdate:modelValue":s[7]||(s[7]=r=>l(n).rankName=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"Creator",prop:"createdBy",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).createdBy,"onUpdate:modelValue":s[8]||(s[8]=r=>l(n).createdBy=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"Create Date",prop:"createdDateRange",class:"custom-form-item"},{default:a(()=>[e(p,{modelValue:l(n).createdDateRange,"onUpdate:modelValue":s[9]||(s[9]=r=>l(n).createdDateRange=r),type:"datetimerange","start-placeholder":"Start date","end-placeholder":"End date",format:"YYYY-MM-DD HH:mm:ss","date-format":"YYYY-MM-DD","time-format":"hh:mm:ss",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_("div",vl,[e(c,{label:"Reject Reason",prop:"rejectReason",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).rejectReason,"onUpdate:modelValue":s[10]||(s[10]=r=>l(n).rejectReason=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"Return Date",prop:"returnedDateRange",class:"custom-form-item"},{default:a(()=>[e(p,{modelValue:l(n).returnedDateRange,"onUpdate:modelValue":s[11]||(s[11]=r=>l(n).returnedDateRange=r),type:"datetimerange","start-placeholder":"Start date","end-placeholder":"End date",format:"YYYY-MM-DD HH:mm:ss","date-format":"YYYY-MM-DD","time-format":"hh:mm:ss",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(c,{label:"Device Type",prop:"deviceType",class:"custom-form-item"},{default:a(()=>[e(o,{modelValue:l(n).deviceType,"onUpdate:modelValue":s[12]||(s[12]=r=>l(n).deviceType=r),placeholder:"Select",clearable:""},{default:a(()=>[(V(!0),I(ee,null,le(l(H),r=>(V(),S(u,{key:r.value,label:r.label,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_("div",gl,[e(c,{label:"EY Asset No",prop:"eyAssetNo",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).eyAssetNo,"onUpdate:modelValue":s[13]||(s[13]=r=>l(n).eyAssetNo=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"Serial No",prop:"serialNo",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).serialNo,"onUpdate:modelValue":s[14]||(s[14]=r=>l(n).serialNo=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"Received By",prop:"receivedBy",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).receivedBy,"onUpdate:modelValue":s[15]||(s[15]=r=>l(n).receivedBy=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1})]),_("div",bl,[e(c,{label:"Engagement Code",prop:"engagementCode",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).engagementCode,"onUpdate:modelValue":s[16]||(s[16]=r=>l(n).engagementCode=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"Engagement Name",prop:"engagementName",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).engagementName,"onUpdate:modelValue":s[17]||(s[17]=r=>l(n).engagementName=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"Cancel Reason",prop:"cancelReason",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).cancelReason,"onUpdate:modelValue":s[18]||(s[18]=r=>l(n).cancelReason=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1})]),_("div",yl,[e(c,{label:"FIDS Receiver",prop:"fidsReceivedBy",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).fidsReceivedBy,"onUpdate:modelValue":s[19]||(s[19]=r=>l(n).fidsReceivedBy=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"FIDS Received Date",prop:"fidsReceivedDateRange",class:"custom-form-item"},{default:a(()=>[e(p,{modelValue:l(n).fidsReceivedDateRange,"onUpdate:modelValue":s[20]||(s[20]=r=>l(n).fidsReceivedDateRange=r),type:"datetimerange","start-placeholder":"Start date","end-placeholder":"End date",format:"YYYY-MM-DD HH:mm:ss","date-format":"YYYY-MM-DD","time-format":"hh:mm:ss",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(c,{label:"Device Location",prop:"deviceLocation",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).deviceLocation,"onUpdate:modelValue":s[21]||(s[21]=r=>l(n).deviceLocation=r),placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1})]),_("div",_l,[e(c,{label:"Approval Date",prop:"approvedDateRange",class:"custom-form-item"},{default:a(()=>[e(p,{modelValue:l(n).approvedDateRange,"onUpdate:modelValue":s[22]||(s[22]=r=>l(n).approvedDateRange=r),type:"datetimerange","start-placeholder":"Start date","end-placeholder":"End date",format:"YYYY-MM-DD HH:mm:ss","date-format":"YYYY-MM-DD","time-format":"hh:mm:ss",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(c,{label:"Reject Date",prop:"rejectedDateRange",class:"custom-form-item"},{default:a(()=>[e(p,{modelValue:l(n).rejectedDateRange,"onUpdate:modelValue":s[23]||(s[23]=r=>l(n).rejectedDateRange=r),type:"datetimerange","start-placeholder":"Start date","end-placeholder":"End date",format:"YYYY-MM-DD HH:mm:ss","date-format":"YYYY-MM-DD","time-format":"hh:mm:ss",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(c,{label:"Approver",prop:"approver",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).approver,"onUpdate:modelValue":s[24]||(s[24]=r=>l(n).approver=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1})]),_("div",Vl,[e(c,{label:"Rejecter",prop:"rejecter",class:"custom-form-item"},{default:a(()=>[e(f,{modelValue:l(n).rejecter,"onUpdate:modelValue":s[25]||(s[25]=r=>l(n).rejecter=r),modelModifiers:{trim:!0},placeholder:"",clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"Remark",prop:"remark",class:"custom-form-item"},{default:a(()=>[e(o,{modelValue:l(n).remark,"onUpdate:modelValue":s[26]||(s[26]=r=>l(n).remark=r),placeholder:"Select",clearable:""},{default:a(()=>[(V(!0),I(ee,null,le(l(j),r=>(V(),S(u,{key:r.value,label:r.label,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{class:"custom-form-item"},{default:a(()=>[e(T,{type:"primary",icon:"Search",onClick:h},{default:a(()=>[q("Search")]),_:1}),e(T,{icon:"Refresh",onClick:m},{default:a(()=>[q("Reset")]),_:1})]),_:1})])]),_:1},8,["model"])),[[Be,ae.showSearch]])}}},hl=ce(wl,[["__scopeId","data-v-4cd2ca05"]]),Nl={style:{display:"flex","flex-direction":"column"}},Rl={class:"dialog-footer"},Dl={style:{display:"flex","justify-content":"space-between"}},kl={__name:"index",props:{source:{type:Number,default:1}},emits:["update:loading","getSelectedUser","getSelectedReceiveBy"],setup(ae,{expose:A,emit:Z}){const Q=ae,K=b("first"),{proxy:H}=ve(),j=b(!1),U=b(!1),F=b(""),Y=b([]),M=Z,k=pe({form:{},rules:{}}),{form:n,rules:L}=fe(k),h=()=>{n.value.keyword&&(U.value=!0,Y.value=[],sl({lpn:n.value.keyword}).then(c=>{c.data.response.length>0&&c.data.response.map(C=>{const{lpn:u,gpn:o,sel_EY_Rank:p,first_Name_1:T,last_Name_1:E,sel_Service_Line:r,desc_Management_Unit:te,internet_Addr:J}=C,y={lpn:u,staffNo:o,staffName:T+" "+E,email:J,office:te,serviceLine:r,rankName:p};Y.value.push(y)}),U.value=!1}).catch(c=>{U.value=!1}))};function x(c,C,u){z(c)}const z=c=>{Q.source==1?M("getSelectedUser",c):Q.source==2&&M("getSelectedReceiveBy",c),j.value=!1};function m(){j.value=!1,W()}function W(){n.value={keyword:null},H.resetForm("formRef")}function $(){W(),j.value=!0,F.value="Select User",f()}const s=(c,C)=>{console.log(c,C)},f=()=>{setTimeout(()=>{var c;(c=document.getElementById("lpnField"))==null||c.focus()},100)};return A({handleOpen:$}),(c,C)=>{const u=g("el-input"),o=g("el-button"),p=g("el-table-column"),T=g("el-table"),E=g("el-tab-pane"),r=g("el-tabs"),te=g("el-text"),J=g("el-dialog"),y=ge("loading");return V(),I("div",null,[e(J,{modal:!1,title:F.value,modelValue:j.value,"onUpdate:modelValue":C[2]||(C[2]=i=>j.value=i),width:"45%","close-on-click-modal":!1,"close-on-press-escape":!1,draggable:"",style:{border:"1px solid var(--el-color-primary)"}},{footer:a(()=>[_("div",Rl,[_("div",Dl,[e(te,null,{default:a(()=>[q(P(c.$t("message.SelectUser.6",{num:Y.value.length})),1)]),_:1}),e(o,{onClick:m},{default:a(()=>[q(P(c.$t("message.SelectUser.5")),1)]),_:1})])])]),default:a(()=>[_("div",Nl,[_("div",null,[e(u,{modelValue:l(n).keyword,"onUpdate:modelValue":C[0]||(C[0]=i=>l(n).keyword=i),maxlength:"30",style:{width:"270px"},placeholder:c.$t("message.SelectUser.1"),"prefix-icon":l(qe),clearable:"",onKeyup:B(h,["enter"])},null,8,["modelValue","placeholder","prefix-icon"]),e(o,{type:"primary",onClick:h},{default:a(()=>[q(P(c.$t("message.SelectUser.2")),1)]),_:1})]),e(r,{modelValue:K.value,"onUpdate:modelValue":C[1]||(C[1]=i=>K.value=i),onTabClick:s},{default:a(()=>[e(E,{label:"Users",name:"first"},{default:a(()=>[ne((V(),S(T,{data:Y.value,onRowDblclick:x,style:{width:"100%",height:"400px"}},{default:a(()=>[e(p,{prop:"lpn",label:"LPN",width:"150"}),e(p,{prop:"staffNo",label:"GPN",width:"150"}),e(p,{prop:"staffName",label:"StaffName",width:"250"}),e(p,{prop:"email",label:"Email",width:"250"}),e(p,{prop:"office",label:"Office",width:"150"}),e(p,{prop:"serviceLine",label:"Dept/ServiceLine",width:"150"}),e(p,{prop:"rankName",label:"EYRank",width:"250"}),e(p,{fixed:"right",label:c.$t("message.SelectUser.3"),"min-width":"100"},{default:a(i=>[e(o,{link:"",type:"primary",onClick:t=>z(i.row)},{default:a(()=>[q(P(c.$t("message.SelectUser.4")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[y,U.value]])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["title","modelValue"])])}}},Cl=ce(kl,[["__scopeId","data-v-00dc7f2d"]]),Ul={class:"form-row"},Sl={class:"form-row"},Yl={class:"form-row"},Ll={class:"form-row"},$l={class:"form-row"},xl={class:"form-row"},Fl={class:"form-row"},Pl={class:"form-row"},Bl={class:"dialog-footer"},ql={__name:"index",props:{id:{type:Number,default:0},getDicts:{type:Function,required:!0}},emits:["update:loading","refreshData","updateUnreadCount"],setup(ae,{expose:A,emit:Z}){const Q=ae,{proxy:K}=ve(),{legaldb_device_type:H,legaldb_remark:j,legaldb_office:U,legaldb_email_suffixes:F}=Q.getDicts(),Y=b(null),M=b(null),k=b(!1),n=b(!1),L=b(!1),h=b(1),x=b(""),z=Z;function m(y){h.value=y,Y.value.handleOpen()}function W(y){o.value.lpn=y.lpn,o.value.staffNo=y.staffNo,o.value.rankName=y.rankName,o.value.staffName=y.staffName,o.value.serviceLine=y.serviceLine,o.value.office=y.office,o.value.email=y.email}function $(y){o.value.receivedBy=y.email}const s=(y,i,t)=>{i?f(i)?t():t(new Error("Please enter a 6-digit or 7-digit LPN.")):t(new Error("LPN cannot be empty."))};function f(y){return/^(?:[A-Za-z0-9]{6}|[0-9]{7})$/.test(y)}const c=(y,i,t)=>{i?C(i)?t():t(new Error("Please enter a valid EY email address.")):t(new Error("Email cannot be empty."))};function C(y){const i=[];if(Object.keys(F.value).some(X=>{i.push(F.value[X].value)}),!y)return!1;const t=y.toLowerCase();if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t))return!1;const O=t.split("@")[1];return i.includes(O)}const u=pe({form:{},rules:{staffNo:[{required:!0,message:"StaffNo(GPN) cannot be empty.",trigger:["change","blur"]}],lpn:[{required:!0,validator:s,trigger:["change","blur"]}],staffName:[{required:!0,message:"Staff name cannot be empty.",trigger:["change","blur"]}],office:[{required:!0,message:"Office cannot be empty.",trigger:["change","blur"]}],email:[{required:!0,message:"Please input email address",trigger:["change","blur"]},{type:"email",message:"Please input correct email address",trigger:["blur","change"]}],serviceLine:[{required:!0,message:"ServiceLine cannot be empty.",trigger:["change","blur"]}],rankName:[{required:!0,message:"EYRank cannot be empty.",trigger:["change","blur"]}],status:[{required:!0,message:"Status cannot be empty.",trigger:["change","blur"]}],deviceType:[{required:!0,message:"DeviceType cannot be empty.",trigger:["change","blur"]}],deviceLocation:[{required:!0,message:"DeviceLocation cannot be empty.",trigger:["change","blur"]}],eyAssetNo:[{required:!0,message:"EYAssetNo cannot be empty.",trigger:["change","blur"]},{max:100,message:"EYAssetNo length must not exceed 100 characters.",trigger:["change","blur"]}],serialNo:[{max:100,message:"SerialNo length must not exceed 100 characters.",trigger:["change","blur"]}],remark:[{required:!0,message:"Remark cannot be empty.",trigger:["change","blur"]}],receivedBy:[{required:!0,validator:c,trigger:["change"]}]}}),{form:o,rules:p}=fe(u);function T(){k.value=!1,E()}function E(){o.value.lpn=null,o.value.staffNo=null,o.value.staffName=null,o.value.serviceLine=null,o.value.email=null,o.value.office=null,o.value.rankName=null,o.value.receivedBy=null,K.resetForm("formRef")}const r=()=>{setTimeout(()=>{var y;(y=document.getElementById("lpnField"))==null||y.focus()},100)};function te(){E(),k.value=!0,x.value=Ee.global.t("message.NewDPNRequest.4"),o.value.status="New Record",r()}function J(){const y=M.value.fields;let i=[];y.forEach(t=>{const D=new Promise(O=>{M.value.validateField(t.prop,X=>{O(X)})});i.push(D)}),Promise.all(i).then(t=>{t.every(O=>O)?(L.value=!0,ul(o.value).then(O=>{K.$modal.msgSuccess("Added successfully"),k.value=!1,z("updateUnreadCount","Waiting for Confirmation"),z("refreshData"),L.value=!1}).catch(O=>{L.value=!1})):console.log("表单验证失败")})}return Me(()=>{}),A({handleAdd:te}),(y,i)=>{const t=g("el-input"),D=g("el-form-item"),O=g("el-button"),X=g("el-option"),se=g("el-select"),be=g("el-date-picker"),oe=g("el-form"),we=g("el-dialog"),ue=ge("loading");return V(),I("div",null,[e(we,{modal:!1,title:x.value,modelValue:k.value,"onUpdate:modelValue":i[18]||(i[18]=v=>k.value=v),width:"55%","close-on-click-modal":!1,"close-on-press-escape":!1,draggable:"",overflow:"",style:{border:"1px solid var(--el-color-primary)"}},{footer:a(()=>[_("div",Bl,[e(O,{type:"primary",onClick:J,loading:L.value},{default:a(()=>[q(P(y.$t("message.NewDPNRequest.1")),1)]),_:1},8,["loading"]),e(O,{onClick:T},{default:a(()=>[q(P(y.$t("message.NewDPNRequest.2")),1)]),_:1}),e(O,{onClick:E},{default:a(()=>[q(P(y.$t("message.NewDPNRequest.3")),1)]),_:1})])]),default:a(()=>[ne((V(),S(oe,{ref_key:"formRef",ref:M,onSubmit:i[17]||(i[17]=me(()=>{},["prevent"])),"element-loading-text":"Verifying...",model:l(o),"label-suffix":":",rules:l(p),"label-width":"auto","label-position":"right"},{default:a(()=>[_("div",Ul,[e(D,{label:"LPN",prop:"lpn",class:"left-column"},{default:a(()=>[e(t,{id:"lpnField",modelValue:l(o).lpn,"onUpdate:modelValue":i[0]||(i[0]=v=>l(o).lpn=v),disabled:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(D,{class:"center-column"},{default:a(()=>[e(O,{icon:l(Fe),circle:"",onClick:i[1]||(i[1]=v=>m(1))},null,8,["icon"])]),_:1}),e(D,{label:"Staff No. (GPN)",prop:"staffNo",class:"right-column"},{default:a(()=>[e(t,{modelValue:l(o).staffNo,"onUpdate:modelValue":i[2]||(i[2]=v=>l(o).staffNo=v),disabled:!0,placeholder:""},null,8,["modelValue"])]),_:1})]),_("div",Sl,[e(D,{label:"Staff Name",prop:"staffName",class:"left-column"},{default:a(()=>[e(t,{modelValue:l(o).staffName,"onUpdate:modelValue":i[3]||(i[3]=v=>l(o).staffName=v),disabled:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(D,{class:"center-column"}),e(D,{label:"Email",prop:"email",class:"right-column"},{default:a(()=>[e(t,{modelValue:l(o).email,"onUpdate:modelValue":i[4]||(i[4]=v=>l(o).email=v),disabled:!0,placeholder:""},null,8,["modelValue"])]),_:1})]),_("div",Yl,[e(D,{label:"Office",prop:"office",class:"left-column"},{default:a(()=>[e(t,{modelValue:l(o).office,"onUpdate:modelValue":i[5]||(i[5]=v=>l(o).office=v),disabled:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(D,{class:"center-column"}),e(D,{label:"Dept/Service Line",prop:"serviceLine",class:"right-column"},{default:a(()=>[e(t,{modelValue:l(o).serviceLine,"onUpdate:modelValue":i[6]||(i[6]=v=>l(o).serviceLine=v),disabled:!0,placeholder:""},null,8,["modelValue"])]),_:1})]),_("div",Ll,[e(D,{label:"EY Rank",prop:"rankName",class:"left-column"},{default:a(()=>[e(t,{modelValue:l(o).rankName,"onUpdate:modelValue":i[7]||(i[7]=v=>l(o).rankName=v),disabled:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(D,{class:"center-column"}),e(D,{label:"Status",prop:"status",class:"right-column"},{default:a(()=>[e(se,{modelValue:l(o).status,"onUpdate:modelValue":i[8]||(i[8]=v=>l(o).status=v),placeholder:"Select",clearable:"",disabled:!0},{default:a(()=>[e(X,{key:"New Record",label:"New Record",value:"New Record"})]),_:1},8,["modelValue"])]),_:1})]),_("div",$l,[e(D,{label:"Date Returned to IT",prop:"returnedDate",class:"left-column"},{default:a(()=>[e(be,{clearable:"",modelValue:l(o).returnedDate,"onUpdate:modelValue":i[9]||(i[9]=v=>l(o).returnedDate=v),type:"datetime",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss","date-format":"YYYY-MM-DD","time-format":"hh:mm:ss",placeholder:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(D,{class:"center-column"}),e(D,{label:"Device Type",prop:"deviceType",class:"right-column"},{default:a(()=>[e(se,{modelValue:l(o).deviceType,"onUpdate:modelValue":i[10]||(i[10]=v=>l(o).deviceType=v),placeholder:"Select",clearable:""},{default:a(()=>[(V(!0),I(ee,null,le(l(H),v=>(V(),S(X,{key:v.value,label:v.label,value:v.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_("div",xl,[e(D,{label:"Device Location",prop:"deviceLocation",class:"left-column"},{default:a(()=>[e(se,{modelValue:l(o).deviceLocation,"onUpdate:modelValue":i[11]||(i[11]=v=>l(o).deviceLocation=v),placeholder:"Select",clearable:""},{default:a(()=>[(V(!0),I(ee,null,le(l(U),v=>(V(),S(X,{key:v.value,label:v.label,value:v.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(D,{class:"center-column"}),e(D,{label:"EYAsset No",prop:"eyAssetNo",class:"right-column"},{default:a(()=>[e(t,{modelValue:l(o).eyAssetNo,"onUpdate:modelValue":i[12]||(i[12]=v=>l(o).eyAssetNo=v),maxLength:"100",placeholder:""},null,8,["modelValue"])]),_:1})]),_("div",Fl,[e(D,{label:"Serial No. (For OSS)",prop:"serialNo",class:"left-column"},{default:a(()=>[e(t,{modelValue:l(o).serialNo,"onUpdate:modelValue":i[13]||(i[13]=v=>l(o).serialNo=v),maxLength:"100",placeholder:""},null,8,["modelValue"])]),_:1}),e(D,{class:"center-column"}),e(D,{label:"Remark",prop:"remark",class:"right-column"},{default:a(()=>[e(se,{modelValue:l(o).remark,"onUpdate:modelValue":i[14]||(i[14]=v=>l(o).remark=v),placeholder:"Select",clearable:""},{default:a(()=>[(V(!0),I(ee,null,le(l(j),v=>(V(),S(X,{key:v.value,label:v.label,value:v.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_("div",Pl,[e(D,{label:"Received By",prop:"receivedBy",class:"left-column"},{default:a(()=>[e(t,{modelValue:l(o).receivedBy,"onUpdate:modelValue":i[15]||(i[15]=v=>l(o).receivedBy=v),modelModifiers:{trim:!0},placeholder:"",disabled:!0},null,8,["modelValue"])]),_:1}),e(D,{class:"center-column"},{default:a(()=>[e(O,{icon:l(Fe),circle:"",onClick:i[16]||(i[16]=v=>m(2))},null,8,["icon"])]),_:1}),e(D,{class:"right-column"})])]),_:1},8,["model","rules"])),[[ue,n.value]])]),_:1},8,["title","modelValue"]),e(l(Cl),{ref_key:"selectUserRef",ref:Y,source:h.value,"onUpdate:source":i[19]||(i[19]=v=>h.value=v),onGetSelectedUser:W,onGetSelectedReceiveBy:$},null,8,["source"])])}}},Ml=ce(ql,[["__scopeId","data-v-55bd7a54"]]),El={class:"form-row"},Tl={class:"form-row"},Al={class:"form-row"},jl={class:"form-row"},Il={key:0,class:"form-row"},Kl={class:"form-row"},Hl={class:"form-row"},Ol={class:"form-row"},zl={class:"form-row"},Wl={class:"form-row"},Gl={class:"dialog-footer"},Ql={__name:"index",props:{id:{type:Number,default:0},getDicts:{type:Function,required:!0}},emits:["update:loading","handleUpdate"],setup(ae,{expose:A,emit:Z}){const Q=ae,{proxy:K}=ve(),{legaldb_device_type:H,legaldb_remark:j,legaldb_office:U,legaldb_status:F}=Q.getDicts(),Y=b(null),M=b(0),k=b(!1),n=b(!1),L=b(""),h=b(!1),x=Z,z=pe({form:{},rules:{}}),{form:m,rules:W}=fe(z);function $(){m.value={id:null,staffNo:null,lpn:null,staffName:null,email:null,office:null,serviceLine:null,rankName:null,createdBy:null,created:null,status:null,rejectReason:null,returnedDate:null,deviceType:null,eyAssetNo:null,serialNo:null,remark:null,receivedBy:null,engagementCode:null,engagementName:null,cancelReason:null,fidsReceivedBy:null,fidsReceivedDate:null,deviceLocation:null,approved:null,rejected:null,approver:null,rejecter:null},K.resetForm("formRef")}function s(C,u){$(),M.value=C,h.value=u,k.value=!0,L.value=Ee.global.t("message.DPNRequestView.1"),n.value=!0,dl(C).then(o=>{m.value=o.data,n.value=!1})}function f(){c(),setTimeout(()=>{x("handleUpdate",M.value)},200)}function c(){k.value=!1,$()}return A({handleView:s}),(C,u)=>{const o=g("el-input"),p=g("el-form-item"),T=g("el-option"),E=g("el-select"),r=g("el-date-picker"),te=g("el-form"),J=g("el-button"),y=g("el-dialog"),i=ge("loading");return V(),I("div",null,[e(y,{modal:!1,title:L.value,modelValue:k.value,"onUpdate:modelValue":u[26]||(u[26]=t=>k.value=t),width:"52%","close-on-click-modal":!1,"close-on-press-escape":!1,draggable:"",overflow:"",style:{border:"1px solid var(--el-color-primary)"}},{footer:a(()=>[_("div",Gl,[h.value?(V(),S(J,{key:0,type:"primary",onClick:f},{default:a(()=>[q(P(C.$t("message.DPNRequestView.2")),1)]),_:1})):Re("",!0),e(J,{onClick:c},{default:a(()=>[q(P(C.$t("message.DPNRequestView.3")),1)]),_:1})])]),default:a(()=>[ne((V(),S(te,{ref_key:"formRef",ref:Y,onSubmit:u[25]||(u[25]=me(()=>{},["prevent"])),rules:l(W),"label-width":"auto","label-position":"right"},{default:a(()=>[_("div",El,[e(p,{label:"LPN",prop:"lpn",class:"left-column"},{default:a(()=>[e(o,{id:"lpnField",modelValue:l(m).lpn,"onUpdate:modelValue":u[0]||(u[0]=t=>l(m).lpn=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(p,{class:"center-column"}),e(p,{label:"Staff No. (GPN)",prop:"staffNo",class:"right-column"},{default:a(()=>[e(o,{modelValue:l(m).staffNo,"onUpdate:modelValue":u[1]||(u[1]=t=>l(m).staffNo=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1})]),_("div",Tl,[e(p,{label:"Staff Name",prop:"staffName",class:"left-column"},{default:a(()=>[e(o,{modelValue:l(m).staffName,"onUpdate:modelValue":u[2]||(u[2]=t=>l(m).staffName=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(p,{class:"center-column"}),e(p,{label:"Email",prop:"email",class:"right-column"},{default:a(()=>[e(o,{modelValue:l(m).email,"onUpdate:modelValue":u[3]||(u[3]=t=>l(m).email=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1})]),_("div",Al,[e(p,{label:"Office",prop:"office",class:"left-column"},{default:a(()=>[e(o,{modelValue:l(m).office,"onUpdate:modelValue":u[4]||(u[4]=t=>l(m).office=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(p,{class:"center-column"}),e(p,{label:"Dept/Service Line",prop:"serviceLine",class:"right-column"},{default:a(()=>[e(o,{modelValue:l(m).serviceLine,"onUpdate:modelValue":u[5]||(u[5]=t=>l(m).serviceLine=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1})]),_("div",jl,[e(p,{label:"EY Rank",prop:"rankName",class:"left-column"},{default:a(()=>[e(o,{modelValue:l(m).rankName,"onUpdate:modelValue":u[6]||(u[6]=t=>l(m).rankName=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(p,{class:"center-column"}),e(p,{label:"Status",prop:"status",class:"right-column"},{default:a(()=>[e(E,{modelValue:l(m).status,"onUpdate:modelValue":u[7]||(u[7]=t=>l(m).status=t),placeholder:"Select",class:"readonly-select",onFocus:u[8]||(u[8]=me(()=>{},["prevent"]))},{default:a(()=>[(V(!0),I(ee,null,le(l(F),t=>(V(),S(T,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),l(m).status=="FIDS Received"?(V(),I("div",Il,[e(p,{label:"FIDS Received By",prop:"fidsReceivedBy",class:"left-column"},{default:a(()=>[e(o,{modelValue:l(m).fidsReceivedBy,"onUpdate:modelValue":u[9]||(u[9]=t=>l(m).fidsReceivedBy=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(p,{class:"center-column"}),e(p,{label:"FIDS Received Date",prop:"fidsReceivedDate",class:"right-column"},{default:a(()=>[e(r,{clearable:"",modelValue:l(m).fidsReceivedDate,"onUpdate:modelValue":u[10]||(u[10]=t=>l(m).fidsReceivedDate=t),type:"datetime",readonly:!0,placeholder:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})])):Re("",!0),_("div",Kl,[e(p,{label:"Date Returned to IT",prop:"returnedDate",class:"left-column"},{default:a(()=>[e(r,{clearable:"",modelValue:l(m).returnedDate,"onUpdate:modelValue":u[11]||(u[11]=t=>l(m).returnedDate=t),type:"datetime",readonly:!0,format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss","date-format":"YYYY-MM-DD","time-format":"hh:mm:ss",placeholder:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(p,{class:"center-column"}),e(p,{label:"Device Type",prop:"deviceType",class:"right-column"},{default:a(()=>[e(E,{modelValue:l(m).deviceType,"onUpdate:modelValue":u[12]||(u[12]=t=>l(m).deviceType=t),placeholder:"Select",class:"readonly-select",onFocus:u[13]||(u[13]=me(()=>{},["prevent"]))},{default:a(()=>[(V(!0),I(ee,null,le(l(H),t=>(V(),S(T,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_("div",Hl,[e(p,{label:"Device Location",prop:"deviceLocation",class:"left-column"},{default:a(()=>[e(E,{modelValue:l(m).deviceLocation,"onUpdate:modelValue":u[14]||(u[14]=t=>l(m).deviceLocation=t),placeholder:"Select",class:"readonly-select",onFocus:u[15]||(u[15]=me(()=>{},["prevent"]))},{default:a(()=>[(V(!0),I(ee,null,le(l(U),t=>(V(),S(T,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{class:"center-column"}),e(p,{label:"EYAsset No",prop:"eyAssetNo",class:"right-column"},{default:a(()=>[e(o,{modelValue:l(m).eyAssetNo,"onUpdate:modelValue":u[16]||(u[16]=t=>l(m).eyAssetNo=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1})]),_("div",Ol,[e(p,{label:"Serial No. (For OSS)",prop:"serialNo",class:"left-column"},{default:a(()=>[e(o,{modelValue:l(m).serialNo,"onUpdate:modelValue":u[17]||(u[17]=t=>l(m).serialNo=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(p,{class:"center-column"}),e(p,{label:"Remark",prop:"remark",class:"right-column"},{default:a(()=>[e(E,{modelValue:l(m).remark,"onUpdate:modelValue":u[18]||(u[18]=t=>l(m).remark=t),readonly:!0,placeholder:"Select",class:"readonly-select",onFocus:u[19]||(u[19]=me(()=>{},["prevent"]))},{default:a(()=>[(V(!0),I(ee,null,le(l(j),t=>(V(),S(T,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_("div",zl,[e(p,{label:"Engagement Code",prop:"engagementCode",class:"left-column"},{default:a(()=>[e(o,{modelValue:l(m).engagementCode,"onUpdate:modelValue":u[20]||(u[20]=t=>l(m).engagementCode=t),readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(p,{class:"center-column"}),e(p,{label:"Engagement Name",prop:"engagementName",class:"right-column"},{default:a(()=>[e(o,{modelValue:l(m).engagementName,"onUpdate:modelValue":u[21]||(u[21]=t=>l(m).engagementName=t),readonly:!0,placeholder:"",type:"textarea",rows:1},null,8,["modelValue"])]),_:1})]),_("div",Wl,[e(p,{label:"Received By",prop:"receivedBy",class:"left-column"},{default:a(()=>[e(o,{modelValue:l(m).receivedBy,"onUpdate:modelValue":u[22]||(u[22]=t=>l(m).receivedBy=t),modelModifiers:{trim:!0},readonly:!0,placeholder:""},null,8,["modelValue"])]),_:1}),e(p,{class:"center-column"}),l(m).status=="Rejected"?(V(),S(p,{key:0,label:"Reject Reason",prop:"rejectReason",class:"right-column"},{default:a(()=>[e(o,{modelValue:l(m).rejectReason,"onUpdate:modelValue":u[23]||(u[23]=t=>l(m).rejectReason=t),placeholder:"",type:"textarea",rows:2,readonly:!0},null,8,["modelValue"])]),_:1})):l(m).status=="Cancelled by IT"?(V(),S(p,{key:1,label:"Cancel Reason",prop:"cancelReason",class:"right-column"},{default:a(()=>[e(o,{modelValue:l(m).cancelReason,"onUpdate:modelValue":u[24]||(u[24]=t=>l(m).cancelReason=t),placeholder:"",type:"textarea",rows:2,readonly:!0},null,8,["modelValue"])]),_:1})):(V(),S(p,{key:2,class:"right-column"}))])]),_:1},8,["rules"])),[[i,n.value]])]),_:1},8,["title","modelValue"])])}}},Zl=ce(Ql,[["__scopeId","data-v-911e88dc"]]),Jl={style:{display:"flex","justify-content":"space-between"}},Xl={style:{display:"flex","justify-content":"flex-end"}},ea={style:{display:"flex","flex-direction":"row","margin-top":"-10px",gap:"4px"}},la={__name:"index",props:{loading:{type:Boolean,default:!1}},emits:["update:loading","getFilterResult","getCount"],setup(ae,{expose:A,emit:Z}){const{proxy:Q}=ve(),{legaldb_office:K}=Q.useDict("legaldb_office"),H=Z,j=pe({queryParams:{findWhat:null,scope:[]}}),{queryParams:U}=fe(j),F=b(!0),Y=b([]),M=b(!1),k=b(!1),n=b(!1);De(U.value.scope,s=>{s.length===0?(M.value=!1,k.value=!1):s.length===K.value.length?(M.value=!0,k.value=!1):k.value=!0});const L=s=>{k.value=!1,s?Y.value=K.value.map(f=>f.value):Y.value=[]};function h(s){U.value=s,n.value=!0,$()}const x=()=>{n.value=!1};function z(){return n.value}function m(){F.value=!F.value}function W(){H("update:loading",!0),U.value.scope=F.value?[]:Y.value,Te(U.value).then(s=>{H("getFilterResult",s.table,U.value.findWhat,U.value.scope),H("getCount",s.count),H("update:loading",!1)}).catch(s=>{H("update:loading",!1)}),n.value=!1}const $=()=>{setTimeout(()=>{var s;(s=document.getElementById("inputRef"))==null||s.focus()},10)};return A({show:h,close:x,isShowing:z}),(s,f)=>{const c=g("el-text"),C=g("el-checkbox"),u=g("el-option"),o=g("el-select"),p=g("el-input"),T=g("el-button"),E=g("el-dialog");return V(),S(E,{modelValue:n.value,"onUpdate:modelValue":f[3]||(f[3]=r=>n.value=r),modal:!1,title:"",width:"600",draggable:"",overflow:"","before-close":x,"show-close":!1,style:{border:"1px solid var(--el-color-primary)",padding:"5px"}},{header:a(({close:r,titleId:te,titleClass:J})=>[_("div",Jl,[e(c,{style:{"white-space":"nowrap","font-size":"large"},type:"primary"},{default:a(()=>[q("Filter")]),_:1}),_("div",Xl,[e(C,{label:"Office Scope:",onChange:m}),e(o,{modelValue:Y.value,"onUpdate:modelValue":f[1]||(f[1]=y=>Y.value=y),multiple:"",clearable:"","collapse-tags":"",placeholder:"Select","popper-class":"custom-header","max-collapse-tags":1,disabled:F.value,style:{width:"210px"}},{header:a(()=>[e(C,{modelValue:M.value,"onUpdate:modelValue":f[0]||(f[0]=y=>M.value=y),indeterminate:k.value,onChange:L},{default:a(()=>[q(" All ")]),_:1},8,["modelValue","indeterminate"])]),default:a(()=>[(V(!0),I(ee,null,le(l(K),y=>(V(),S(u,{key:y.value,label:y.label,value:y.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])])])]),default:a(()=>[_("div",null,[_("div",ea,[e(c,{style:{"white-space":"nowrap"}},{default:a(()=>[q("Find what:")]),_:1}),e(p,{id:"inputRef",modelValue:l(U).findWhat,"onUpdate:modelValue":f[2]||(f[2]=r=>l(U).findWhat=r),placeholder:"",clearable:"",onKeyup:B(W,["enter"])},null,8,["modelValue"]),e(T,{type:"primary",icon:l(qe),onClick:W},{default:a(()=>[q("Find")]),_:1},8,["icon"])])])]),_:1},8,["modelValue"])}}},aa=ce(la,[["__scopeId","data-v-dcb2c5fd"]]),ta={class:"app-container"},oa={class:"total-records"},na=rl({name:"DPNRequest"}),ra=Object.assign(na,{setup(ae){const{proxy:A}=ve(),{legaldb_device_type:Z,legaldb_remark:Q,legaldb_office:K,legaldb_email_suffixes:H}=A.useDict("legaldb_device_type","legaldb_remark","legaldb_office","legaldb_email_suffixes"),j=b([]),U=b(null),F=b(null),Y=b(null),M=b(null),k=b(!1),n=b(!0),L=b(!1),h={Approved:0,"Cancelled by IT":0,Formatted:0,Rejected:0,"Waiting for Confirmation":0,"Pending Legal Review":0},x=b(new Map(Object.entries(h))),z=b([]),m=b(!0),W=b(!0),$=b(0),s=pe({queryParams:{pageNum:1,pageSize:Number(Pe.local.get("displayPageRows"))||10,status:"Approved"}}),{queryParams:f}=fe(s),c=b(0),C=b(0),u=b(0),o=b(0),p=b(0),T=b(0),E=b(0),r=ol(),te=G(()=>new Intl.NumberFormat().format(c.value)),J=G(()=>new Intl.NumberFormat().format(C.value)),y=G(()=>new Intl.NumberFormat().format(u.value)),i=G(()=>new Intl.NumberFormat().format(o.value)),t=G(()=>new Intl.NumberFormat().format(p.value)),D=G(()=>new Intl.NumberFormat().format(T.value)),O=G(()=>new Intl.NumberFormat().format(E.value));function X(d){c.value=d.totalCount,C.value=d.approvedCount,u.value=d.cancelledByITCount,o.value=d.formattedCount,p.value=d.rejectedCount,T.value=d.waitingForConfirmationCount,E.value=d.pendingLegalReviewCount}function se(d,w,re){f.value.findWhat=w,f.value.scope=re,be(d,f.value)}function be(d,w){j.value=d.rows,$.value=d.total,f.value=w,k.value=!1}function oe(d){A.$refs.searchForm.initGetList(d)}function we(){oe(f.value.status)}function ue(){A.$refs.searchForm.resetQuery()}function v(){A.$modal.confirm("Do you want to proceed with bulk approval?").then(function(){return ml().then(d=>{d.data.updates>0?(A.$modal.msgSuccess("Batch approval successful"),Ne("Approved",d.data.approvedNum),Ne("Pending Legal Review",d.data.pendingLegalReviewNum)):A.$modal.msgSuccess("No records were processed")})}).then(()=>{ue()}).catch(()=>{})}const Ae=d=>{L.value=d},ke=()=>{U.value.show(f.value)};function je(d){z.value=d.map(w=>w.id),m.value=d.length!=1,W.value=!d.length}function Ie(d,w,re){Ue(d)}function Ke(){F.value.handleAdd()}function Ce(d){Y.value.handleEdit(d)}function Ue(d){const w=Se(d.status);M.value.handleView(d.id,w)}function ye(){return{legaldb_device_type:Z,legaldb_remark:Q,legaldb_office:K,legaldb_email_suffixes:H}}function he(){return r.roles[0]=="FIDS"}function Se(d){if(d=="Approved")return!he();if(d=="Cancelled by IT")return!1;if(d=="Formatted")return!1;if(d=="Rejected")return!0;if(d==="Waiting for Confirmation")return!he();if(d==="Pending Legal Review")return!he()}const Ye=d=>{Ne(d,1)},Ne=(d,w)=>{x.value.has(d)&&x.value.set(d,x.value.get(d)+w)},He=d=>{x.value.has(d)&&x.value.set(d,0)},Oe=G(()=>x.value.get("Waiting for Confirmation")||0),ze=G(()=>x.value.get("Approved")||0),We=G(()=>x.value.get("Cancelled by IT")||0),Ge=G(()=>x.value.get("Formatted")||0),Qe=G(()=>x.value.get("Rejected")||0),Ze=G(()=>x.value.get("Pending Legal Review")||0);De(()=>f.value.status,(d,w)=>{He(w)},{immediate:!0}),Me(()=>{window.addEventListener("keydown",Le),oe(f.value.status)}),nl(()=>{window.removeEventListener("keydown",Le)});function Le(d){d.ctrlKey&&d.key==="h"&&(d.preventDefault(),U.value.isShowing()?U.value.close():ke()),d.ctrlKey&&d.key==="j"&&(d.preventDefault(),L.value=!L.value)}return(d,w)=>{const re=g("el-button"),$e=g("el-col"),xe=g("el-row"),de=g("el-radio-button"),ie=g("el-badge"),Je=g("el-radio-group"),Xe=g("right-toolbar"),R=g("el-table-column"),el=g("el-table"),ll=g("pagination"),_e=ge("hasPermi"),al=ge("loading");return V(),I("div",ta,[e(l(hl),{ref:"searchForm",showSearch:l(L),loading:l(k),"onUpdate:loading":w[0]||(w[0]=N=>Ve(k)?k.value=N:null),onGetSearchResult:be,onGetCount:X,getDicts:ye},null,8,["showSearch","loading"]),e(xe,{gutter:10,class:"mb8"},{default:a(()=>[e($e,{span:1.5},{default:a(()=>[ne((V(),S(re,{type:"primary",icon:"Plus",onClick:Ke},{default:a(()=>[q(P(d.$t("message.DPNRequest.1")),1)]),_:1})),[[_e,["legaldatabase:DPNRequest:add"]]])]),_:1}),e($e,{span:1.5},{default:a(()=>[ne((V(),S(re,{plain:"",icon:"Finished",onClick:v},{default:a(()=>[q(P(d.$t("message.DPNRequest.2")),1)]),_:1})),[[_e,["legaldatabase:DPNRequest:bulkApproval"]]])]),_:1})]),_:1}),e(xe,{gutter:10,class:"mb8",style:{"padding-left":"5px","margin-top":"20px"}},{default:a(()=>[e(Je,{modelValue:l(f).status,"onUpdate:modelValue":w[7]||(w[7]=N=>l(f).status=N)},{default:a(()=>[e(ie,{value:l(ze),max:10,class:"item",offset:[-10,0],"show-zero":!1,color:"var(--el-color-primary)"},{default:a(()=>[e(de,{label:`Approved ${l(J)}`,value:"Approved",class:"equal-width-radio",style:{"border-left":"1px solid var(--el-border-color)"},onClick:w[1]||(w[1]=N=>oe("Approved"))},null,8,["label"])]),_:1},8,["value"]),e(ie,{value:l(We),max:10,class:"item",offset:[-10,0],"show-zero":!1,color:"var(--el-color-primary)"},{default:a(()=>[e(de,{label:`Cancelled by IT ${l(y)}`,value:"Cancelled by IT",class:"equal-width-radio",onClick:w[2]||(w[2]=N=>oe("Cancelled by IT"))},null,8,["label"])]),_:1},8,["value"]),e(ie,{value:l(Ge),max:10,class:"item",offset:[-10,0],"show-zero":!1,color:"var(--el-color-primary)"},{default:a(()=>[e(de,{label:`Formatted ${l(i)}`,value:"Formatted",class:"equal-width-radio",onClick:w[3]||(w[3]=N=>oe("Formatted"))},null,8,["label"])]),_:1},8,["value"]),e(ie,{value:l(Qe),max:10,class:"item",offset:[-10,0],"show-zero":!1,color:"var(--el-color-primary)"},{default:a(()=>[e(de,{label:`Rejected ${l(t)}`,value:"Rejected",class:"equal-width-radio",onClick:w[4]||(w[4]=N=>oe("Rejected"))},null,8,["label"])]),_:1},8,["value"]),e(ie,{value:l(Oe),max:10,class:"item",offset:[-10,0],"show-zero":!1,color:"var(--el-color-primary)"},{default:a(()=>[e(de,{label:`Waiting for Confirmation ${l(D)}`,value:"Waiting for Confirmation",class:"equal-width-radio",onClick:w[5]||(w[5]=N=>oe("Waiting for Confirmation"))},null,8,["label"])]),_:1},8,["value"]),e(ie,{value:l(Ze),max:10,class:"item",offset:[-10,0],"show-zero":!1,color:"var(--el-color-primary)"},{default:a(()=>[e(de,{label:`Pending Legal Review ${l(O)}`,value:"Pending Legal Review",class:"equal-width-radio",onClick:w[6]||(w[6]=N=>oe("Pending Legal Review"))},null,8,["label"])]),_:1},8,["value"])]),_:1},8,["modelValue"]),e(Xe,{showSearch:l(L),"onUpdate:showSearch":w[8]||(w[8]=N=>Ve(L)?L.value=N:null),showFind:l(n),onQueryTable:ue,onShowOrHide:Ae,onOpenFind:ke},null,8,["showSearch","showFind"])]),_:1}),e(l(aa),{ref_key:"findDialog",ref:U,loading:l(k),"onUpdate:loading":w[9]||(w[9]=N=>Ve(k)?k.value=N:null),onGetFilterResult:se,onGetCount:X},null,8,["loading"]),ne((V(),S(el,{data:l(j),onSelectionChange:je,onRowDblclick:Ie,style:{"margin-top":"10px"}},{default:a(()=>[e(R,{label:"ID",align:"left",prop:"id"}),e(R,{label:"Staff No",align:"left",prop:"staffNo",width:"155"}),e(R,{label:"LPN",align:"left",prop:"lpn",width:"155"}),e(R,{label:"Staff Name",align:"left",prop:"staffName",width:"155"}),e(R,{label:"Email",align:"left",prop:"email",width:"255"}),e(R,{label:"Office",align:"left",prop:"office",width:"155"}),e(R,{label:"Department/Service Line",align:"left",prop:"serviceLine",width:"255"}),e(R,{label:"EY Rank",align:"left",prop:"rankName",width:"205"}),e(R,{label:"Created By",align:"left",prop:"createdBy",width:"255"}),e(R,{label:"Status",align:"left",prop:"status",width:"255"}),e(R,{label:"Reject Reason",align:"left",prop:"rejectReason",width:"500"}),e(R,{label:"Date Returned to IT",align:"left",prop:"returnedDate",width:"180"},{default:a(N=>[_("span",null,P(d.parseTime(N.row.returnedDate,"{y}-{m}-{d} {h}:{i}:{s}")),1)]),_:1}),e(R,{label:"Device Type",align:"left",prop:"deviceType",width:"155"}),e(R,{label:"EY Asset No",align:"left",prop:"eyAssetNo",width:"255"}),e(R,{label:"Serial No",align:"left",prop:"serialNo",width:"255"}),e(R,{label:"Remark",align:"left",prop:"remark",width:"355"}),e(R,{label:"Received By",align:"left",prop:"receivedBy",width:"255"}),e(R,{label:"Engagement Code",align:"left",prop:"engagementCode",width:"155"}),e(R,{label:"Engagement Name",align:"left",prop:"engagementName",width:"355"}),e(R,{label:"Cancel Reason",align:"left",prop:"cancelReason",width:"255"}),e(R,{label:"FIDS Received By",align:"left",prop:"fidsReceivedBy",width:"155"}),e(R,{label:"FIDS Received Date",align:"left",prop:"fidsReceivedDate",width:"180"},{default:a(N=>[_("span",null,P(d.parseTime(N.row.fidsReceivedDate,"{y}-{m}-{d} {h}:{i}:{s}")),1)]),_:1}),e(R,{label:"Device Location",align:"left",prop:"deviceLocation",width:"155"}),e(R,{label:"Approved Time",align:"left",prop:"approved",width:"180"},{default:a(N=>[_("span",null,P(d.parseTime(N.row.approved,"{y}-{m}-{d} {h}:{i}:{s}")),1)]),_:1}),e(R,{label:"Rejected Time",align:"left",prop:"rejected",width:"180"},{default:a(N=>[_("span",null,P(d.parseTime(N.row.rejected,"{y}-{m}-{d} {h}:{i}:{s}")),1)]),_:1}),e(R,{label:"Approver",align:"left",prop:"approver",width:"255"}),e(R,{label:"Rejecter",align:"left",prop:"rejecter",width:"255"}),e(R,{label:"Created Time",align:"left",prop:"created",width:"180"},{default:a(N=>[_("span",null,P(d.parseTime(N.row.created,"{y}-{m}-{d} {h}:{i}:{s}")),1)]),_:1}),e(R,{label:"CreatedBy",align:"left",prop:"createdBy",width:"255"}),e(R,{label:"Updated Time",align:"left",prop:"updateTime",width:"180"},{default:a(N=>[_("span",null,P(d.parseTime(N.row.updateTime,"{y}-{m}-{d} {h}:{i}:{s}")),1)]),_:1}),e(R,{label:"UpdateBy",align:"left",prop:"updateBy",width:"255"}),e(R,{fixed:"right",label:"Operations",align:"center",width:"110"},{default:a(N=>[ne((V(),S(re,{link:"",type:"primary",onClick:tl=>Ue(N.row)},{default:a(()=>[q(P(d.$t("message.DPNRequest.3")),1)]),_:2},1032,["onClick"])),[[_e,["legaldatabase:DPNRequest:view"]]]),Se(N.row.status)?ne((V(),S(re,{key:0,link:"",type:"primary",onClick:tl=>Ce(N.row.id)},{default:a(()=>[q(P(d.$t("message.DPNRequest.4")),1)]),_:2},1032,["onClick"])),[[_e,["legaldatabase:DPNRequest:edit"]]]):Re("",!0)]),_:1})]),_:1},8,["data"])),[[al,l(k)]]),_("div",oa,P(d.$t("message.DPNRequest.5"))+": "+P(l(te)),1),ne(e(ll,{total:l($),page:l(f).pageNum,"onUpdate:page":w[10]||(w[10]=N=>l(f).pageNum=N),limit:l(f).pageSize,"onUpdate:limit":w[11]||(w[11]=N=>l(f).pageSize=N),onPagination:we},null,8,["total","page","limit"]),[[Be,l($)>0]]),e(l(Ml),{ref_key:"addDialog",ref:F,onRefreshData:ue,onUpdateUnreadCount:Ye,getDicts:ye},null,512),e(l(il),{ref_key:"editDialog",ref:Y,onRefreshData:ue,onUpdateUnreadCount:Ye,getDicts:ye},null,512),e(l(Zl),{ref_key:"viewDialog",ref:M,onHandleUpdate:Ce,getDicts:ye},null,512)])}}}),da=ce(ra,[["__scopeId","data-v-e185a1cf"]]);export{da as default};
