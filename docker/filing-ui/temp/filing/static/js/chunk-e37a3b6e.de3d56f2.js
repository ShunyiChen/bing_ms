(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e37a3b6e"],{"3a75":function(e,t,a){"use strict";a("d42b")},"4d0d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[e.searchSuccess?a("div",{staticStyle:{"border-bottom":"1px solid grey","margin-bottom":"10px"}},[a("span",[e._v(" Staff ID: "+e._s(e.staffId)+" ")]),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(" Borrower: "+e._s(e.staffName)+" ")])]):e._e(),e.searchFail?a("div",{staticStyle:{"border-bottom":"1px solid grey","margin-bottom":"10px",color:"red"}},[e._v(" Staff is not in database. ")]):e._e(),e.showStaffID?a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"auto","label-suffix":":"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$t("lend.labelInputStaffId"),prop:"staffId"}},[a("el-input",{staticStyle:{width:"200px","margin-right":"5px"},attrs:{maxlength:"20",clearable:"",placeholder:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm("staffID")}},model:{value:e.form.staffId,callback:function(t){e.$set(e.form,"staffId","string"===typeof t?t.trim():t)},expression:"form.staffId"}}),a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return t.preventDefault(),function(){return e.submitForm("staffID")}()}}},[e._v(e._s(e.$t("lend.btnFetch")))])],1)],1):e._e(),e.showConfirmedMessage?a("div",e._l(e.messageList,(function(t){return a("ul",{key:t.oldSystemfileID,staticStyle:{margin:"0",padding:"3px 10px"}},[a("li",{style:"color: "+("OK"==t.status?"#13ce66":"red")},[e._v(e._s(e.addStyle(t.oldSystemfileID,t.status)))])])})),0):e._e(),e.showFileID?a("el-form",{ref:"fileIDForm",attrs:{model:e.fileIDForm,"label-width":"auto"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"File ID:",prop:"fileID",required:""}},[a("el-input",{ref:"fileIDTextField",staticStyle:{width:"200px","margin-right":"5px"},attrs:{clearable:"",placeholder:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm("fileID")}},model:{value:e.fileIDForm.fileID,callback:function(t){e.$set(e.fileIDForm,"fileID","string"===typeof t?t.trim():t)},expression:"fileIDForm.fileID"}}),a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return t.preventDefault(),function(){return e.submitForm("fileID")}()}}},[e._v(e._s(e.$t("lend.btnFetch")))]),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.handleRefresh}})],1)],1):e._e(),e.showFileID?a("div",[a("span",[e._v(" "+e._s(e.$t("lend.txtOutstanding"))+":"+e._s(e.total)+" ")]),e.total>0?a("i",{staticClass:"el-icon-download",staticStyle:{cursor:"pointer","padding-left":"10px","font-weight":"600","font-size":"large"},attrs:{id:"exportNode"},on:{click:e.handleExport}}):e._e(),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:e.profileList,"cell-style":e.firstColumnStyle,"header-cell-style":e.headerColStyle},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{label:"File ID",align:"center",width:"150",prop:"oldSystemfileID"}}),a("el-table-column",{attrs:{label:"Group",align:"center",width:"400",prop:"clientGroupName"}}),a("el-table-column",{attrs:{label:"Client Name",align:"center",width:"400",prop:"clientCompanyName"}}),a("el-table-column",{attrs:{label:"Y.E.D.",align:"center",width:"100",prop:"yearEndDate"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.yearEndDate,"{y}-{m}-{d}")))])]}}],null,!1,2864419401)}),a("el-table-column",{attrs:{label:"File Type",align:"center",width:"100",prop:"fileType"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileType))])]}}],null,!1,2515862232)}),a("el-table-column",{attrs:{label:"Description",align:"center",width:"350",prop:"fileDescription"}}),a("el-table-column",{attrs:{label:"Location",align:"center",width:"100",prop:"areaLocation"}}),a("el-table-column",{attrs:{label:"Remarks",align:"center",width:"200",prop:"fileremarks"}}),a("el-table-column",{attrs:{label:"Borrow Date",align:"center",width:"100",prop:"loanDate"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.loanDate,"{y}-{m}-{d}")))])]}}],null,!1,921748901)}),a("el-table-column",{attrs:{label:"Box No",align:"center",width:"150",prop:"boxNumber"}})],1)],1):e._e(),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.searchByPaging}}),e.showTotalFiles?a("div",[a("span",[e._v(" There is(are) total "+e._s(e.totalSelected)+" files in the list. ")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:e.selectedProfileList,"cell-style":e.columnStyle,"header-cell-style":e.headerColStyle},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{fixed:"",label:"File ID",align:"center",width:"150",prop:"oldSystemfileID"}}),a("el-table-column",{attrs:{label:"Group",align:"center",width:"400",prop:"clientGroupName"}}),a("el-table-column",{attrs:{label:"Client Name",align:"center",width:"400",prop:"clientCompanyName"}}),a("el-table-column",{attrs:{label:"Y.E.D.",align:"center",width:"200",prop:"yearEndDate"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.yearEndDate,"{y}-{m}-{d}")))])]}}],null,!1,2864419401)}),a("el-table-column",{attrs:{label:"File Type",align:"center",width:"200",prop:"fileType"}}),a("el-table-column",{attrs:{label:"Description",align:"center",width:"200",prop:"fileDescription"}}),a("el-table-column",{attrs:{label:"File Status",align:"center",width:"200",prop:"status"}}),a("el-table-column",{attrs:{label:"Location",align:"center",width:"100",prop:"areaLocation"}}),a("el-table-column",{attrs:{label:"Actions",fixed:"right",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteRow(t.$index,e.selectedProfileList)}}},[e._v(" "+e._s(e.$t("lend.linkRemove"))+" ")])]}}],null,!1,1816866461)})],1)],1):e._e(),this.showConfirm?a("div",{staticStyle:{"text-align":"center","margin-top":"5px"}},[a("el-button",{attrs:{type:"primary",loading:e.confirmLoading},on:{click:e.handleConfirm}},[e._v(e._s(e.$t("lend.btnConfirm")))])],1):e._e()],1)},n=[],l=a("5530"),r=(a("ac1f"),a("00b4"),a("d9e2"),a("4de4"),a("d3b7"),a("14d9"),a("a434"),a("d81d"),a("d7a3")),o={name:"Lend",data:function(){var e=function(e,t,a){var i=/^[0-9]*$/;i.test(t)?a():a(new Error("FileID must be a numeric value"))};return{form:{staffId:"",staffName:"",staffEmail:""},fileIDForm:{fileID:""},rules:{staffId:[{required:!0,message:"StaffID cannot be blank",trigger:"click"}],fileID:[{required:!0,message:"FileID cannot be blank",trigger:["click","blur"]},{validator:e,trigger:"blur"}]},btnLoading:!1,loading:!1,confirmLoading:!1,searchSuccess:!1,searchFail:!1,showStaffID:!0,showFileID:!1,showTotalFiles:!1,showConfirmedMessage:!1,queryParams:{pageNum:1,pageSize:10,staffID:"",staffName:""},total:0,profileList:[],selectedProfileList:[],messageList:[],prohibitBorrowing:!1,staffId:"",staffName:""}},computed:{showConfirm:{get:function(){return this.selectedProfileList.length>0},set:function(e){}},totalSelected:{get:function(){return this.selectedProfileList.length},set:function(e){}}},methods:{addStyle:function(e,t){return"OK"==t?"FileID: "+e+" successfully borrowed.":"FileID: "+e+" is not available for lending."},clearInputBoxForNextEntry:function(){this.fileIDForm.fileID="",this.$refs.fileIDTextField.focus()},submitForm:function(e){var t=this;if(this.showConfirmedMessage=!1,"staffID"===e)this.$refs["form"].validate((function(e){if(e){t.btnLoading=!0;var a={lpn:t.form.staffId};Object(r["c"])(a).then((function(e){void 0!=e.data?(t.fileIDForm.fileID="",t.form.staffName=e.data.staffName,t.form.staffEmail=e.data.staffEmail,t.searchSuccess=!0,t.searchFail=!1,t.staffId=t.form.staffId,t.staffName=t.form.staffName):(t.searchSuccess=!1,t.searchFail=!0),t.btnLoading=!1,t.searchSuccess&&(t.showStaffID=!1,t.showFileID=!0,t.queryParams.staffID=t.form.staffId,t.queryParams.staffName=t.form.staffName,t.handleRefresh())})).catch((function(e){t.btnLoading=!1}))}}));else{if(this.total>0)return void this.$alert("Files not returned after 6 months cannot be borrowed again.","Borrowing Tips",{confirmButtonText:"OK",callback:function(e){}});this.$refs["fileIDForm"].validate((function(e){e&&(t.searchSuccess=!0,t.showFileID=!0,t.showStaffID=!1,t.showTotalFiles=!0,t.btnLoading=!0,Object(r["b"])({fileID:t.fileIDForm.fileID}).then((function(e){if(t.btnLoading=!1,void 0==e.data){var a={oldSystemfileID:t.fileIDForm.fileID,status:"Not in Database"},i=t.selectedProfileList.filter((function(e){return e.oldSystemfileID==a.oldSystemfileID})).length;0==i&&t.selectedProfileList.push(a)}else{var n=t.selectedProfileList.filter((function(t){return t.oldSystemfileID==e.data.oldSystemfileID})).length;0==n&&t.selectedProfileList.push(e.data)}t.clearInputBoxForNextEntry()})).catch((function(e){t.btnLoading=!1,t.clearInputBoxForNextEntry()})))}))}},handleRefresh:function(){var e=this;this.queryParams.staffID=this.form.staffId,this.queryParams.staffName=this.form.staffName,Object(r["d"])(this.queryParams).then((function(t){e.profileList=t.rows,e.total=t.total})).catch((function(e){}))},handleExport:function(){this.download("filingsystem/filing/borrowrecord/exportOutstandingFiles",Object(l["a"])({},this.queryParams),"Over6MonthsOutstandingFile(s)_".concat((new Date).getTime(),".xlsx"))},handleSelectionChange:function(){},searchByPaging:function(){var e=this;Object(r["d"])(this.queryParams).then((function(t){e.profileList=t.rows,e.total=t.total})).catch((function(e){}))},deleteRow:function(e,t){t.splice(e,1)},handleConfirm:function(){var e=this;this.confirmLoading=!0,this.messageList=this.selectedProfileList;var t=this.selectedProfileList.filter((function(e){return"OK"==e.status})).map((function(e){return e.oldSystemfileID})),a=this.selectedProfileList.filter((function(e){return"OK"==e.status})).map((function(e){return e.deptId}));if(t.length>0){var i={staffID:this.form.staffId,staffName:this.form.staffName,staffEmail:this.form.staffEmail,status:1,fileIDs:t,deptIds:a};Object(r["a"])(i).then((function(t){e.showConfirmedMessage=!0,e.reset(),setTimeout((function(){e.$refs.form.clearValidate()}),10)})).catch((function(t){e.reset()}))}else this.showConfirmedMessage=!0,this.reset(),setTimeout((function(){e.$refs.form.clearValidate()}),10)},reset:function(){this.showStaffID=!0,this.showFileID=!1,this.showTotalFiles=!1,this.profileList=[],this.selectedProfileList=[],this.total=0,this.btnLoading=!1,this.confirmLoading=!1,this.form.staffID=""},firstColumnStyle:function(e,t,a,i){return"color: black;padding:2px 0px;"},columnStyle:function(e,t,a,i){return"Not Available"==e.row.status||"Not in Database"==e.row.status?"color: red;padding:0px 0px;":"color: #13ce66;padding:0px 0px;"},headerColStyle:function(e,t,a,i){return"padding:0px 0px;height:10px"}}},s=o,f=(a("3a75"),a("2877")),c=Object(f["a"])(s,i,n,!1,null,"c431bbee",null);t["default"]=c.exports},d42b:function(e,t,a){},d7a3:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var i=a("b775");function n(e){return Object(i["a"])({url:"/filingsystem/filing/borrowrecord/fetchStaffByID",method:"post",data:e})}function l(e){return Object(i["a"])({url:"/filingsystem/filing/borrowrecord/getBorrowRecordsByStaffID",method:"post",data:e})}function r(e){return Object(i["a"])({url:"/filingsystem/filing/borrowrecord/fetchBorrowFile",method:"post",data:e})}function o(e){return Object(i["a"])({url:"/filingsystem/filing/borrowrecord/borrowConfirm",method:"post",data:e})}}}]);