(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-94c316e0"],{2527:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[e.confirmedSuccessfully?i("div",{style:"border-bottom: 1px solid grey;margin-bottom: 10px;color:"+this.themeColor},[e._v(" Operation Completed ")]):e._e(),i("DestructionSearch",{ref:"DestructionSearch",attrs:{loading:e.loading,api:"Destruction",show:e.showSearch,pageSize:e.queryParams.pageSize},on:{getResult:e.receiveSearchResult,resetPageInfo:e.resetPageInfo,"update:loading":function(t){e.loading=t},"update:show":function(t){e.showSearch=t},"update:pageSize":function(t){return e.$set(e.queryParams,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParams,"pageSize",t)}}}),i("div",[i("el-row",{attrs:{gutter:10}},[i("right-toolbar",{attrs:{showSearch:e.showSearch,columns:e.columns},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.searchByPaging}})],1)],1),e.showFileList?i("div",{staticStyle:{"margin-top":"5px"}},[i("span",[e._v(" Your search return "+e._s(e.total)+" results ")]),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"fileTable",attrs:{border:"",data:e.profileList,"cell-style":e.firstColumnStyle,"header-cell-style":e.headerColStyle},on:{"selection-change":e.handleFileSelectionChange}},[e.columns[0].visible?i("el-table-column",{key:Math.random(),attrs:{label:"Box No",align:"center",width:"160",prop:"boxNumber"}}):e._e(),e.columns[1].visible?i("el-table-column",{key:Math.random(),attrs:{fixed:"",label:"File ID",align:"center",width:"150",prop:"oldSystemfileID"}}):e._e(),e.columns[2].visible?i("el-table-column",{key:Math.random(),attrs:{label:"Group",align:"center",width:"400",prop:"clientGroupName"}}):e._e(),e.columns[3].visible?i("el-table-column",{key:Math.random(),attrs:{label:"Client Name",align:"center",width:"400",prop:"clientCompanyName"}}):e._e(),e.columns[4].visible?i("el-table-column",{key:Math.random(),attrs:{label:"File Type",align:"center",width:"100",prop:"fileType"}}):e._e(),e.columns[5].visible?i("el-table-column",{key:Math.random(),attrs:{label:"Binder No",align:"center",width:"400",prop:"binderNo"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.fileDescription))])]}}],null,!1,3503077478)}):e._e(),e.columns[6].visible?i("el-table-column",{key:Math.random(),attrs:{label:"Available",align:"center",width:"220",prop:"avail"}}):e._e(),e.columns[7].visible?i("el-table-column",{key:Math.random(),attrs:{label:"File Status",align:"center",width:"150",prop:"fileState"}}):e._e(),e.columns[8].visible?i("el-table-column",{key:Math.random(),attrs:{label:"isDPN?",align:"center",width:"100",prop:"isDPN"}}):e._e(),e.columns[9].visible?i("el-table-column",{key:Math.random(),attrs:{label:"Retention Date",align:"center",width:"180",prop:"retentionDate"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.parseTime(t.row.retentionDate,"{y}-{m}-{d}")))])]}}],null,!1,2710040573)}):e._e(),e.columns[10].visible?i("el-table-column",{key:Math.random(),attrs:{label:"A.R.D.",align:"center",width:"180",prop:"auditReportDate"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.parseTime(t.row.auditReportDate,"{y}-{m}-{d}")))])]}}],null,!1,2407544522)}):e._e(),i("el-table-column",{key:Math.random(),attrs:{width:"175",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:function(i){return e.handleFileCheckboxChange(t,i)}},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}}),i("span",{staticStyle:{"margin-left":"3px",color:"rgb(83,90,110)"}},[e._v("Destroyed?")])]}},{key:"default",fn:function(t){return[i("el-checkbox",{key:Math.random(),on:{change:function(i){return e.onFileCheckBoxChange(t.row,i)}},model:{value:t.row.checked,callback:function(i){e.$set(t.row,"checked",i)},expression:"scope.row.checked"}})]}}],null,!1,703771663)})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.searchByPaging}})],1):e._e(),e.showBoxList?i("div",{staticStyle:{"margin-top":"5px"}},[i("span",[e._v(" Your search return "+e._s(e.total)+" results ")]),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"boxTable",attrs:{border:"",data:e.boxList,"cell-style":e.columnStyle,"header-cell-style":e.headerColStyle},on:{"selection-change":e.handleBoxSelectionChange}},[i("el-table-column",{key:Math.random(),attrs:{fixed:"",label:"Box No",align:"center",width:"160",prop:"boxNumber"}}),i("el-table-column",{key:Math.random(),attrs:{label:"File ID",align:"center",width:"1000",prop:"fileIDs"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"flex","flex-direction":"row","flex-wrap":"wrap"}},[null!=t.row.fileIDs?i("div",{staticStyle:{display:"flex","flex-direction":"row","flex-wrap":"wrap"}},e._l(t.row.fileIDs.split(","),(function(o,n){return i("div",[e.hasErr(n,t.row)?i("el-popover",{attrs:{placement:"top",title:"","close-delay":0,width:"auto",trigger:"hover"}},[i("div",[i("span",{staticClass:"span-wrapper",staticStyle:{color:"black"}},[i("i",{staticClass:"el-icon-info"}),e._v(e._s(e.getErrMsg(n,t.row))+" ")])]),i("div",{attrs:{slot:"reference"},slot:"reference"},[i("el-tag",{style:"cursor: pointer;margin: 2px 2px;color:black;height:23px;line-height:23px;",attrs:{effect:"light",type:"danger",size:"medium"}},[e._v(" "+e._s(o)+" ")])],1)]):i("div",{attrs:{slot:"reference"},slot:"reference"},[i("el-tag",{style:"margin: 2px 2px;color:black;height:23px;line-height:23px;",attrs:{effect:"light",type:"info",size:"medium"}},[e._v(" "+e._s(o)+" ")])],1)],1)})),0):e._e()])]}}],null,!1,2413120903)}),i("el-table-column",{key:Math.random(),attrs:{label:"Location",align:"center",width:"200",prop:"areaLocation"}}),i("el-table-column",{key:Math.random(),attrs:{width:"175",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:function(i){return e.handleBoxCheckboxChange(t,i)}},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}}),i("span",{staticStyle:{"margin-left":"3px",color:"rgb(83,90,110)"}},[e._v("Destroyed?")])]}},{key:"default",fn:function(t){return[i("el-checkbox",{key:Math.random(),on:{change:function(i){return e.onBoxCheckBoxChange(t.row,i)}},model:{value:t.row.checked,callback:function(i){e.$set(t.row,"checked",i)},expression:"scope.row.checked"}})]}}],null,!1,1172401487)})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.searchByPaging}})],1):e._e(),i("div",{staticClass:"button-pane"},[this.showFileConfirm?i("div",[i("el-button",{attrs:{type:"primary",loading:e.confirmLoading},on:{click:function(){return e.handleConfirm("File Confirm")}}},[e._v("File Confirm")])],1):e._e(),this.showBoxConfirm?i("div",[i("el-button",{attrs:{type:"primary",loading:e.confirmLoading},on:{click:function(){return e.handleConfirm("Box Confirm")}}},[e._v("Box Confirm")])],1):e._e()])],1)},n=[],a=i("b85c"),r=(i("a9e3"),i("d3b7"),i("159b"),i("d81d"),i("caad"),i("2532"),i("ad14")),l=i("9b43"),s={name:"Filedestroy",components:{DestructionSearch:r["a"]},data:function(){return{btnLoading:!1,btnBoxLoading:!1,loading:!1,confirmLoading:!1,showFileList:!1,showBoxList:!1,confirmedSuccessfully:!1,queryParams:{pageNum:1,pageSize:Number(this.$cache.local.get("displayPageRows"))||10},total:0,profileList:[],boxList:[],multipleSelection:[],confirmFileIDs:[],checkAll:!1,isIndeterminate:!1,showSearch:!0,columns:[{key:0,label:"Box No",visible:!0},{key:1,label:"File ID",visible:!0},{key:2,label:"Group",visible:!0},{key:3,label:"Client Name",visible:!0},{key:4,label:"File Type",visible:!0},{key:5,label:"Binder No",visible:!0},{key:6,label:"Available",visible:!0},{key:7,label:"File Status",visible:!0},{key:8,label:"isDPN?",visible:!0},{key:9,label:"Retention Date",visible:!0},{key:10,label:"A.R.D.",visible:!0}],boxTablecolumns:[{key:1,label:"Box No",visible:!0},{key:2,label:"File ID",visible:!0},{key:3,label:"Location",visible:!0}]}},activated:function(){this.$refs.DestructionSearch.isFormEmpty()||this.$refs.DestructionSearch.handleQueryByPageNum(this.queryParams.pageNum,this.queryParams.pageSize)},computed:{themeColor:{get:function(){return"#FFE600"==this.$store.state.settings.theme?"black":this.$store.state.settings.theme}},boxNum:{get:function(){return this.boxNoPrefix+this.boxNoSuffix+""},set:function(e){}},showFileConfirm:{get:function(){return this.showFileList&&this.profileList.length>0},set:function(e){}},showBoxConfirm:{get:function(){return this.showBoxList&&this.boxList.length>0},set:function(e){}}},methods:{searchByPaging:function(){this.loading=!0,this.$refs.DestructionSearch.handleQueryByPageNum(this.queryParams.pageNum,this.queryParams.pageSize)},receiveSearchResult:function(e,t){"File Search"==t?(this.btnLoading=!1,this.showFileList=!0,this.showBoxList=!1,this.profileList=e.rows,this.total=e.total,this.loading=!1,this.checkAll=!1,this.isIndeterminate=!1):(this.btnBoxLoading=!1,this.showFileList=!1,this.showBoxList=!0,this.boxList=e.rows,this.total=e.total,this.loading=!1,this.checkAll=!1,this.isIndeterminate=!1)},resetPageInfo:function(){this.queryParams.pageNum=1,this.queryParams.pageSize=Number(this.$cache.local.get("displayPageRows"))||10},hasErr:function(e,t){var i=t.isDPNs.split(",")[e],o=t.fileStates.split(",")[e],n=t.borrowStates.split(",")[e],a=t.isMoveds.split(",")[e];return"Y"==i||("DESTROYED"==o||"LOSE"==o||("Y"==a||(1==n||(""==t.boxNumber||null==t.boxNumber))))},getErrMsg:function(e,t){var i=t.isDPNs.split(",")[e],o=t.fileStates.split(",")[e],n=t.borrowStates.split(",")[e],a=t.isMoveds.split(",")[e];return"Y"==i?"File(s) with DPN equal to Y cannot be destroyed!":"DESTROYED"==o||"LOSE"==o?"The destroyed/lose file(s) cannot be destroyed again!":"Y"==a?"File(s) moved to another city cannot be destroyed!":1==n?"The file(s) currently being borrowed cannot be destroyed!":(""==t.boxNumber||null==t.boxNumber)&&"Unboxed file(s) cannot be destroyed!"},tableContentStyle:function(e){if(null==e.fileIDs)return"";for(var t=e.fileIDs.split(","),i=e.isDPNs.split(","),o=e.borrowStates.split(","),n=e.fileStates.split(","),a=e.isMoveds.split(","),r="",l=0;l<t.length;l++)"Y"==i[l]||1==o[l]||"DESTROYED"==n[l]||"LOSE"==n[l]||"Y"==a[l]?r+="<span style='color:red;'>".concat(t[l],"</span>"):r+="<span style=''>".concat(t[l],"</span>"),l!=t.length-1&&(r+=",");return r},onFileCheckBoxChange:function(e,t){this.$refs.fileTable.toggleRowSelection(e,t)},onBoxCheckBoxChange:function(e,t){this.$refs.boxTable.toggleRowSelection(e,t)},handleFileCheckboxChange:function(e,t){this.profileList.forEach((function(e){e.checked=t})),t?this.$refs.fileTable.toggleAllSelection():this.$refs.fileTable.clearSelection()},handleBoxCheckboxChange:function(e,t){this.boxList.forEach((function(e){e.checked=t})),t?this.$refs.boxTable.toggleAllSelection():this.$refs.boxTable.clearSelection()},handleFileSelectionChange:function(e){this.multipleSelection=e,this.checkAll=this.multipleSelection.length===this.profileList.length;var t=this.multipleSelection.length>0&&this.multipleSelection.length<this.profileList.length;this.isIndeterminate=t},handleBoxSelectionChange:function(e){this.multipleSelection=e,this.checkAll=this.multipleSelection.length===this.boxList.length;var t=this.multipleSelection.length>0&&this.multipleSelection.length<this.boxList.length;this.isIndeterminate=t},handleConfirm:function(e){var t=this;if(0!=this.multipleSelection.length)if("File Confirm"==e){var i,o=Object(a["a"])(this.multipleSelection);try{for(o.s();!(i=o.n()).done;){var n=i.value;if(""==n.boxNumber||null==n.boxNumber)return void this.$modal.alert("Unboxed file(s) cannot be destroyed!");if("Yes"!=n.avail)return void this.$modal.alert("The file(s) currently being borrowed cannot be destroyed!");if("DESTROYED"==n.fileState||"LOSE"==n.fileState)return void this.$modal.alert("The destroyed/lose file(s) cannot be destroyed again!");if("Y"==n.isDPN)return void this.$modal.alert("File(s) with DPN equal to Y cannot be destroyed!");if("Y"==n.isMoved)return void this.$modal.alert("File(s) moved to another city cannot be destroyed!")}}catch(f){o.e(f)}finally{o.f()}this.confirmLoading=!0;var r=this.multipleSelection.map((function(e){return e.oldSystemfileID}));this.isIndeterminate=!1,r.length>0?Object(l["c"])(r).then((function(e){t.confirmLoading=!1,t.showFileList=!1,t.showBoxList=!1,t.confirmedSuccessfully=!0,t.multipleSelection=[]})).catch((function(e){t.confirmLoading=!1})):this.confirmLoading=!1}else{var s,c=Object(a["a"])(this.multipleSelection);try{for(c.s();!(s=c.n()).done;){var u=s.value;if(null==u.fileIDs||u.isDPNs.includes("Y")||u.fileStates.includes("DESTROYED")||u.borrowStates.includes("1")||u.isMoveds.includes("Y"))return void this.$modal.alert("Empty or Red-tagged boxes cannot be destroyed!")}}catch(f){c.e(f)}finally{c.f()}this.confirmLoading=!0,this.isIndeterminate=!1;var m={boxIds:this.multipleSelection.map((function(e){return e.boxID})),boxNumbers:this.multipleSelection.map((function(e){return e.boxNumber})),destroyer:""};Object(l["a"])(m).then((function(e){t.confirmLoading=!1,t.showFileList=!1,t.showBoxList=!1,t.confirmedSuccessfully=!0,t.multipleSelection=[],t.checkAll=!1})).catch((function(e){t.confirmLoading=!1}))}else this.$modal.alert("Please select check box!")},firstColumnStyle:function(e,t,i,o){return"Yes"!=e.row.avail||"DESTROYED"==e.row.fileState||"LOSE"==e.row.fileState||""==e.row.boxNumber||null==e.row.boxNumber||"Y"==e.row.isDPN||"Y"==e.row.isMoved?"color: red;padding:0px 0px;":"color: black;padding:2px 0px;"},columnStyle:function(e,t,i,o){return"color: black;padding:0px 0px;"},headerColStyle:function(e,t,i,o){return"padding:0px 0px;height:10px"}}},c=s,u=(i("7180"),i("2877")),m=Object(u["a"])(c,o,n,!1,null,"5f39f5e7",null);t["default"]=m.exports},"4ebe":function(e,t,i){},7180:function(e,t,i){"use strict";i("4ebe")},"81ec":function(e,t,i){},"9b43":function(e,t,i){"use strict";i.d(t,"d",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return l}));var o=i("b775");function n(e){return Object(o["a"])({url:"/filingsystem/filing/destruction/fileSearch",method:"post",data:e})}function a(e){return Object(o["a"])({url:"/filingsystem/filing/destruction/boxSearch",method:"post",data:e})}function r(e){return Object(o["a"])({url:"/filingsystem/filing/destruction/fileConfirm",method:"post",data:e})}function l(e){return Object(o["a"])({url:"/filingsystem/filing/destruction/boxConfirm",method:"post",data:e})}},ad14:function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}]},[i("div",[i("el-form",{ref:"form",staticClass:"custom-form",attrs:{inline:!0,model:e.form,rules:e.rules,"label-width":"auto","label-position":"right","label-suffix":":"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery("File Search")}}},[i("div",{staticClass:"form-row"},[i("el-form-item",{staticClass:"custom-form-item",attrs:{label:"File ID",prop:"fileID"}},[i("el-input",{staticStyle:{width:"275px"},attrs:{name:"FileIDFrom",maxlength:"12",clearable:""},model:{value:e.form.fileID,callback:function(t){e.$set(e.form,"fileID","string"===typeof t?t.trim():t)},expression:"form.fileID"}})],1),i("el-form-item",{staticClass:"custom-form-item",attrs:{label:"File Type",prop:"fileType"}},[i("el-select",{staticStyle:{width:"275px"},attrs:{filterable:"",clearable:"",placeholder:""},model:{value:e.form.fileType,callback:function(t){e.$set(e.form,"fileType",t)},expression:"form.fileType"}},e._l(e.fileTypes,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{staticClass:"custom-form-item",attrs:{label:"Retention Date",prop:"retentionDate"}},[i("el-date-picker",{staticStyle:{width:"275px"},attrs:{type:"daterange",align:"right",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:e.handleRDChange},model:{value:e.form.retentionDate,callback:function(t){e.$set(e.form,"retentionDate",t)},expression:"form.retentionDate"}})],1)],1),i("div",{staticClass:"form-row"},[i("el-form-item",{staticClass:"custom-form-item",attrs:{label:"Box No",prop:"boxPrefix"}},[i("div",{staticStyle:{display:"flex","flex-direction":"row"}},[i("el-input",{staticStyle:{width:"135px"},attrs:{name:"boxNumberPrefix",maxlength:"10",clearable:"","auto-complete":"on"},model:{value:e.form.boxPrefix,callback:function(t){e.$set(e.form,"boxPrefix","string"===typeof t?t.trim():t)},expression:"form.boxPrefix"}}),e._v(" - "),i("el-input",{staticStyle:{width:"135px"},attrs:{name:"boxNumberSuffix",maxlength:"8",clearable:"","auto-complete":"on"},model:{value:e.form.boxSuffix,callback:function(t){e.$set(e.form,"boxSuffix","string"===typeof t?t.trim():t)},expression:"form.boxSuffix"}})],1)]),i("el-form-item",{staticClass:"custom-form-item",attrs:{label:"Location",prop:"deptId"}},[i("el-select",{staticStyle:{width:"275px"},attrs:{filterable:"",clearable:""},model:{value:e.form.deptId,callback:function(t){e.$set(e.form,"deptId",t)},expression:"form.deptId"}},e._l(e.areaLocations,(function(e){return i("el-option",{key:e.deptId,attrs:{label:e.locationName,value:e.deptId}})})),1)],1),i("el-form-item",{staticClass:"custom-form-item",attrs:{prop:"includeDestructionRecords"}},[i("el-checkbox",{staticStyle:{"font-weight":"bold"},model:{value:e.form.includeDestructionRecords,callback:function(t){e.$set(e.form,"includeDestructionRecords",t)},expression:"form.includeDestructionRecords"}},[e._v("Include Non-destructible")])],1)],1),i("div",{staticClass:"form-row"},[i("el-form-item",{staticClass:"custom-form-item"}),i("el-form-item",{staticClass:"custom-form-item"}),i("el-form-item",{staticClass:"custom-form-item"},[i("el-button",{attrs:{type:"primary",loading:e.btnFileSearchLoading},on:{click:function(t){return t.preventDefault(),function(){return e.handleQuery("File Search")}()}}},[e._v("File Search")]),i("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:function(t){return e.resetQuery("File Search")}}},[e._v("Reset")])],1)],1)])],1),i("div",{staticStyle:{"text-align":"center","border-bottom":"1px solid #D9D9D9","margin-top":"5px","margin-bottom":"10px"}}),i("div",[i("el-form",{ref:"form2",staticClass:"custom-form",attrs:{inline:!0,model:e.form2,"label-width":"auto","label-position":"right","label-suffix":":"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery("Box Search")}}},[i("div",{staticClass:"form-row"},[i("el-form-item",{staticClass:"custom-form-item",staticStyle:{"padding-left":"40px"},attrs:{label:"Box No",prop:"boxPrefix"}},[i("div",{staticStyle:{display:"flex","flex-direction":"row"}},[i("el-input",{staticStyle:{width:"135px"},attrs:{name:"boxNumberPrefix",maxlength:"10",clearable:"","auto-complete":"on"},model:{value:e.form2.boxPrefix,callback:function(t){e.$set(e.form2,"boxPrefix","string"===typeof t?t.trim():t)},expression:"form2.boxPrefix"}}),e._v(" - "),i("el-input",{staticStyle:{width:"135px"},attrs:{name:"boxNumberSuffix",maxlength:"8",clearable:"","auto-complete":"on"},model:{value:e.form2.boxSuffix,callback:function(t){e.$set(e.form2,"boxSuffix","string"===typeof t?t.trim():t)},expression:"form2.boxSuffix"}})],1)]),i("el-form-item",{staticClass:"custom-form-item",staticStyle:{"padding-left":"40px"},attrs:{label:"Location",prop:"areaLocation"}},[i("el-select",{staticStyle:{width:"275px"},attrs:{filterable:"",clearable:""},model:{value:e.form2.areaLocation,callback:function(t){e.$set(e.form2,"areaLocation",t)},expression:"form2.areaLocation"}},e._l(e.areaLocations,(function(e){return i("el-option",{key:e.deptId,attrs:{label:e.locationName,value:e.locationName}})})),1)],1),i("el-form-item",{staticClass:"custom-form-item"},[i("el-button",{attrs:{type:"primary",loading:e.btnBoxSearchLoading},on:{click:function(t){return t.preventDefault(),function(){return e.handleQuery("Box Search")}()}}},[e._v("Box Search")]),i("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:function(t){return e.resetQuery("Box Search")}}},[e._v("Reset")])],1)],1)])],1)])},n=[],a=(i("a9e3"),i("ac1f"),i("00b4"),i("d9e2"),i("4de4"),i("d3b7"),i("498a"),i("25f0"),i("3032")),r=i("9b43"),l=i("b775");function s(e){return Object(l["a"])({url:"/filingsystem/filing/destructionhistory/getFileHistory",method:"post",data:e})}function c(e){return Object(l["a"])({url:"/filingsystem/filing/destructionhistory/getBoxHistory",method:"post",data:e})}i("c466");var u={name:"DestructionSearch",props:{show:{required:!0,type:Boolean,default:!0},loading:{required:!0,type:Boolean,default:!1},api:{required:!1,type:String,default:""},pageSize:{required:!0,type:Number}},data:function(){var e=function(e,t,i){var o=/^[0-9]*$/;null==t||o.test(t)?i():i(new Error("-"))};return{btnFileSearchLoading:!1,btnBoxSearchLoading:!1,areaLocations:[],fileTypes:["A","T","I","O"],pickerOptions:{shortcuts:[{text:"最近一天",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-864e5),e.$emit("pick",[i,t])}},{text:"最近三天",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e5),e.$emit("pick",[i,t])}},{text:"最近一周",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-7776e6),e.$emit("pick",[i,t])}}]},queryParams:{pageNum:1,pageSize:this.pageSize},opt:null,form:{fileID:null,fileType:null,boxNumber:null,boxPrefix:"",boxSuffix:"",retentionDate:null,retentionDateFrom:null,retentionDateTo:null,includeDestructionRecords:!1,deptId:null},form2:{boxNumber:null,boxPrefix:"",boxSuffix:"",areaLocation:"",deptId:null},rules:{fileID:[{validator:e,trigger:"blur"}]},count:0}},watch:{"form2.areaLocation":{handler:function(e,t){""==e&&(this.form2.deptId=null)}}},computed:{boxNumber:{get:function(){return this.form.boxPrefix+this.form.boxSuffix},set:function(e){}},boxNumber2:{get:function(){return this.form2.boxPrefix+this.form2.boxSuffix},set:function(e){}}},created:function(){this.initLocationList()},methods:{initLocationList:function(){var e=this;Object(a["g"])({}).then((function(t){e.areaLocations=t.data})).catch((function(t){e.count<2&&(e.count++,setTimeout((function(){e.initLocationList()}),1e3))}))},handleQuery:function(e){this.opt=e,this.handleQueryByPageNum(0,this.pageSize),this.$emit("resetPageInfo")},handleQueryByPageNum:function(e,t){var i=this;this.queryParams.pageNum=e,this.queryParams.pageSize=t,this.$refs["form"].validate((function(e){e&&(i.updateParentLoading(!0),"Destruction"==i.api?"File Search"==i.opt?(i.form["pageNum"]=i.queryParams.pageNum,i.form["pageSize"]=i.queryParams.pageSize,i.form.boxNumber=i.boxNumber,i.btnFileSearchLoading=!0,Object(r["d"])(i.form).then((function(e){i.$emit("getResult",e,i.opt),i.btnFileSearchLoading=!1,i.updateParentLoading(!1)})).catch((function(e){i.btnFileSearchLoading=!1,i.updateParentLoading(!1)}))):(i.form2["pageNum"]=i.queryParams.pageNum,i.form2["pageSize"]=i.queryParams.pageSize,i.form2.boxNumber=i.boxNumber2,""!=i.form2.areaLocation&&(i.form2.deptId=i.areaLocations.filter((function(e){return e.locationName==i.form2.areaLocation}))[0].deptId),i.btnBoxSearchLoading=!0,Object(r["b"])(i.form2).then((function(e){i.$emit("getResult",e,i.opt),i.btnBoxSearchLoading=!1,i.updateParentLoading(!1)})).catch((function(e){i.btnBoxSearchLoading=!1,i.updateParentLoading(!1)}))):"DestructionHistory"==i.api&&("File Search"==i.opt?(i.form["pageNum"]=i.queryParams.pageNum,i.form["pageSize"]=i.queryParams.pageSize,i.form.boxNumber=i.boxNumber,i.btnFileSearchLoading=!0,s(i.form).then((function(e){i.$emit("getResult",e,i.form,i.opt),i.btnFileSearchLoading=!1,i.updateParentLoading(!1)})).catch((function(e){i.btnFileSearchLoading=!1,i.updateParentLoading(!1)}))):(i.form2["pageNum"]=i.queryParams.pageNum,i.form2["pageSize"]=i.queryParams.pageSize,i.form2.boxNumber=i.boxNumber2,""!=i.form2.areaLocation&&(i.form2.deptId=i.areaLocations.filter((function(e){return e.locationName==i.form2.areaLocation}))[0].deptId),i.btnBoxSearchLoading=!0,c(i.form2).then((function(e){i.$emit("getResult",e,i.form2,i.opt),i.btnBoxSearchLoading=!1,i.updateParentLoading(!1)})).catch((function(e){i.btnBoxSearchLoading=!1,i.updateParentLoading(!1)})))))}))},resetQuery:function(e){"File Search"==e?(this.resetForm("form"),this.form.boxSuffix="",this.form.retentionDateFrom=null,this.form.retentionDateTo=null):(this.resetForm("form2"),this.form2.boxSuffix="")},updateParentLoading:function(e){this.$emit("update:loading",e)},isFormEmpty:function(){for(var e in this.form)if("includeDestructionRecords"!=e&&"pageNum"!=e&&"pageSize"!=e&&null!=this.form[e]&&""!=this.form[e].toString().trim())return!1;return!0},handleRDChange:function(e){e&&2===e.length?(this.form.retentionDateFrom=e[0],this.form.retentionDateTo=e[1]):(this.form.retentionDateFrom=null,this.form.retentionDateTo=null)}}},m=u,f=(i("dc51"),i("2877")),d=Object(f["a"])(m,o,n,!1,null,"463dc154",null);t["a"]=d.exports},dc51:function(e,t,i){"use strict";i("81ec")}}]);