import{W}from"./userAvatar.vue_vue_type_style_index_0_scoped_7ae87b86_lang-Dq02FpWw.js";import{j as A}from"./user-08E3g9Ea.js";import{_ as D,b as H,r as _,K as q,h as i,o as h,c as O,k as c,f as l,d as t,e as a,j as P,l as j,L as E,m as x,I as F,p as G,q as z,v as J}from"./index-B_VQirsb.js";const K=f=>(G("data-v-7ae87b86"),f=f(),z(),f),M=["src"],Q={class:"avatar-upload-preview"},X=["src"],Y=K(()=>c("br",null,null,-1)),Z={__name:"userAvatar",setup(f){const m=H(),{proxy:p}=J(),d=_(!1),g=_(!1),y=_("修改头像"),o=q({img:m.avatar,autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0,outputType:"png",filename:"avatar",previews:{}});function w(){d.value=!0}function b(){g.value=!0}function $(){}function k(){p.$refs.cropper.rotateLeft()}function B(){p.$refs.cropper.rotateRight()}function v(n){n=n||1,p.$refs.cropper.changeScale(n)}function R(n){if(n.type.indexOf("image/")==-1)p.$modal.msgError("文件格式错误，请上传图片类型,如：JPG，PNG后缀的文件。");else{const e=new FileReader;e.readAsDataURL(n),e.onload=()=>{o.img=e.result,o.filename=n.name}}}function S(){p.$refs.cropper.getCropBlob(n=>{let e=new FormData;e.append("avatarfile",n,o.filename),A(e).then(s=>{d.value=!1,o.img="/sysmgmt/prod-api"+s.imgUrl,m.avatar=o.img,p.$modal.msgSuccess("修改成功"),g.value=!1})})}function U(n){o.previews=n}function I(){o.img=m.avatar,o.visible=!1}return(n,e)=>{const s=i("el-col"),C=i("el-row"),T=i("Upload"),V=i("el-icon"),u=i("el-button"),L=i("el-upload"),N=i("el-dialog");return h(),O("div",{class:"user-info-head",onClick:e[6]||(e[6]=r=>w())},[c("img",{src:l(o).img,title:"点击上传头像",class:"img-circle img-lg"},null,8,M),t(N,{title:l(y),modelValue:l(d),"onUpdate:modelValue":e[5]||(e[5]=r=>F(d)?d.value=r:null),width:"800px","append-to-body":"",onOpened:b,onClose:I},{default:a(()=>[t(C,null,{default:a(()=>[t(s,{xs:24,md:12,style:{height:"350px"}},{default:a(()=>[l(g)?(h(),P(l(W),{key:0,ref:"cropper",img:l(o).img,info:!0,autoCrop:l(o).autoCrop,autoCropWidth:l(o).autoCropWidth,autoCropHeight:l(o).autoCropHeight,fixedBox:l(o).fixedBox,outputType:l(o).outputType,onRealTime:U},null,8,["img","autoCrop","autoCropWidth","autoCropHeight","fixedBox","outputType"])):j("",!0)]),_:1}),t(s,{xs:24,md:12,style:{height:"350px"}},{default:a(()=>[c("div",Q,[c("img",{src:l(o).previews.url,style:E(l(o).previews.img)},null,12,X)])]),_:1})]),_:1}),Y,t(C,null,{default:a(()=>[t(s,{lg:2,md:2},{default:a(()=>[t(L,{action:"#","http-request":$,"show-file-list":!1,"before-upload":R},{default:a(()=>[t(u,null,{default:a(()=>[x(" 选择 "),t(V,{class:"el-icon--right"},{default:a(()=>[t(T)]),_:1})]),_:1})]),_:1})]),_:1}),t(s,{lg:{span:1,offset:2},md:2},{default:a(()=>[t(u,{icon:"Plus",onClick:e[0]||(e[0]=r=>v(1))})]),_:1}),t(s,{lg:{span:1,offset:1},md:2},{default:a(()=>[t(u,{icon:"Minus",onClick:e[1]||(e[1]=r=>v(-1))})]),_:1}),t(s,{lg:{span:1,offset:1},md:2},{default:a(()=>[t(u,{icon:"RefreshLeft",onClick:e[2]||(e[2]=r=>k())})]),_:1}),t(s,{lg:{span:1,offset:1},md:2},{default:a(()=>[t(u,{icon:"RefreshRight",onClick:e[3]||(e[3]=r=>B())})]),_:1}),t(s,{lg:{span:2,offset:6},md:2},{default:a(()=>[t(u,{type:"primary",onClick:e[4]||(e[4]=r=>S())},{default:a(()=>[x("提 交")]),_:1})]),_:1})]),_:1})]),_:1},8,["title","modelValue"])])}}},ae=D(Z,[["__scopeId","data-v-7ae87b86"]]);export{ae as default};
